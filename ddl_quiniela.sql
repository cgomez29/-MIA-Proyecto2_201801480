CREATE TABLE ROL(
    idRol NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    name VARCHAR2(100) NOT NULL,
    PRIMARY KEY(idRol)
);

CREATE TABLE FASE(
    idFase NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    nombre VARCHAR2(100) NOT NULL,
    PRIMARY KEY(idFase)
);

CREATE TABLE DEPORTE (
    idDeporte NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    nombre VARCHAR2(100) NOT NULL CONSTRAINT d_name UNIQUE,
    imagen VARCHAR2(255) NULL,
    color VARCHAR(100) NULL,
    PRIMARY KEY(idDeporte)
);


CREATE TABLE MEMBRESIA (
    idMembresia NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    nombre VARCHAR2(100) NOT NULL,
    precio FLOAT NOT NULL,  
    PRIMARY KEY(idMembresia)
);

CREATE TABLE TEMPORADA (
    idTemporada NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    nombre VARCHAR2(100) NOT NULL CONSTRAINT d_nombre UNIQUE,
    fechaInicio DATE NULL,
    fechaFin DATE NULL,
    estado INT NULL,
    PRIMARY KEY(idTemporada)
);

CREATE TABLE USUARIO (
    idUsuario NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    username VARCHAR2(200) NOT NULL,
    password VARCHAR2(255) NOT NULL,
    name VARCHAR(150) NOT NULL,
    surname VARCHAR(150) NOT NULL,
    tier VARCHAR(100) NULL,
    fecha_nacimiento TIMESTAMP NULL,
    fecha_registro TIMESTAMP NOT NULL,
    email VARCHAR2(255) NULL,
    photo VARCHAR2(255) NULL,
    idRol NUMBER NOT NULL,
    PRIMARY KEY (idUsuario),
    FOREIGN KEY (idRol) REFERENCES ROL(idRol)
);

CREATE TABLE MENSAJE (
    idMensaje NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    contenido VARCHAR2(255) NOT NULL,
    fechar_hora TIMESTAMP NOT NULL,
    idChat NUMBER NOT NULL,
    idUsuario NUMBER NOT NULL,
    idAdmin NUMBER NOT NULL,
    PRIMARY KEY(idMensaje),
    FOREIGN KEY(idUsuario) REFERENCES USUARIO(idUsuario),
    FOREIGN KEY(idAdmin) REFERENCES USUARIO(idUsuario)
);


CREATE TABLE RECOMPENSA (
    idRecompensa NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    score NUMBER NOT NULL,
    premio FLOAT NOT NULL,
    tier VARCHAR2(200) NOT NULL,
    ultimo FLOAT NOT NULL, /* DINERO*/
    fecha DATE NOT NULL,
    incremento NUMBER NOT NULL,
    idUsuario NUMBER NOT NULL,
    idTemporada NUMBER NOT NULL, 
    PRIMARY KEY(idRecompensa),
    FOREIGN KEY(idUsuario) REFERENCES USUARIO(idUsuario),
    FOREIGN KEY(idTemporada) REFERENCES TEMPORADA(idTemporada)
);

CREATE TABLE JORNADA (
    idJornada NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    name VARCHAR(100) NOT NULL,
    fecha_hora_inicio TIMESTAMP NOT NULL,
    fecha_hora_fin TIMESTAMP NOT NULL,
    idFase NUMBER NOT NULL,
    idTemporada NUMBER NOT NULL,
    PRIMARY KEY(idJornada),
    FOREIGN KEY(idFase) REFERENCES FASE(idFase),
    FOREIGN KEY(idTemporada) REFERENCES TEMPORADA(idTemporada)
);

CREATE TABLE DETALLE_USUARIO (
    id_detalle_usuario NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    score NUMBER NOT NULL,
    incremento NUMBER NOT NULL,
    pos_anterior NUMBER NOT NULL, /*Posicion anterior*/
    p_10 NUMBER NOT NULL,    
    p_5 NUMBER NOT NULL,    
    p_3 NUMBER NOT NULL,    
    p_0 NUMBER NOT NULL,    
    idTemporada NUMBER NOT NULL,
    idMembresia NUMBER NOT NULL,
    idUsuario NUMBER NOT NULL,
    PRIMARY KEY(id_detalle_usuario),
    FOREIGN KEY(idTemporada) REFERENCES TEMPORADA(idTemporada),
    FOREIGN KEY(idMembresia) REFERENCES MEMBRESIA(idMembresia),
    FOREIGN KEY(idUsuario) REFERENCES USUARIO(idUsuario)    
);

CREATE TABLE EVENTO (
    idEvento NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    fecha_hora TIMESTAMP NOT NULL,
    estado NUMBER NOT NULL,
    local VARCHAR2(150) NOT NULL, 
    visitante VARCHAR2(150) NOT NULL,  
    idJornada NUMBER NOT NULL,
    idDeporte NUMBER NOT NULL,
    PRIMARY KEY(idEvento),
    FOREIGN KEY(idJornada) REFERENCES JORNADA(idJornada),
    FOREIGN KEY(idDeporte) REFERENCES DEPORTE(idDeporte)    
);


CREATE TABLE RESULTADO (
    idResultado NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    visitante NUMBER NOT NULL,
    local NUMBER NOT NULL,
    idEvento NUMBER NOT NULL,
    PRIMARY KEY(idResultado),
    FOREIGN KEY(idEvento) REFERENCES EVENTO(idEvento)
);


/*CREATE TABLE RESULTADO (
    idResultado NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    visitante NUMBER NOT NULL,
    local NUMBER NOT NULL,
    idEvento NUMBER NOT NULL,
    PRIMARY KEY(idResultado),
    FOREIGN KEY(idEvento) REFERENCES EVENTO(idEvento)
);*/

/*CREATE TABLE EQUIPO (
    idEquipo NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    nombre VARCHAR2(200) NOT NULL,
    PRIMARY KEY(idEquipo)
);*/


/*CREATE TABLE DETALLE_EVENTO (
    idDetalle_Evento NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    tipo VARCHAR2(200) NOT NULL, -- VISITANTE | LOCAL
    idEvento NUMBER NOT NULL,
    idEquipo NUMBER NOT NULL,
    PRIMARY KEY(idDetalle_Evento),
    FOREIGN KEY(idEvento) REFERENCES EVENTO(idEvento),
    FOREIGN KEY(idEquipo) REFERENCES EQUIPO(idEquipo)
);*/

CREATE TABLE PREDICCION (
    idPrediccion NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    local NUMBER NOT NULL,
    visitante NUMBER NOT NULL,
    idEvento NUMBER NOT NULL,
    idUsuario NUMBER NOT NULL,
    PRIMARY KEY(idPrediccion),
    FOREIGN KEY(idEvento) REFERENCES EVENTO(idEvento),
    FOREIGN KEY(idUsuario) REFERENCES USUARIO(idUsuario)
);


